name: ğŸš€ Enhanced Autonomous Bot v3.0

on:
  schedule:
    # Multiple random times throughout the day
    - cron: '0 9 * * *'   # 09:00 UTC
    - cron: '0 14 * * *'  # 14:00 UTC
    - cron: '0 18 * * *'  # 18:00 UTC
    - cron: '0 22 * * *'  # 22:00 UTC
  workflow_dispatch:
    # Allow manual trigger

jobs:
  enhanced-commit:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ¤– Checkout Repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0

    - name: ğŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: âš™ï¸ Configure Git
      run: |
        git config --global user.name "Gynzrt"
        git config --global user.email "Gynzrt@users.noreply.github.com"

    - name: ğŸ² Random Delay (Natural Timing)
      run: |
        # Add random delay 0-30 minutes for natural behavior
        DELAY=$((RANDOM % 1800))
        echo "â° Waiting ${DELAY} seconds for natural timing..."
        sleep $DELAY

    - name: ğŸš€ Run Enhanced Bot
      run: |
        python enhanced_bot.py

    - name: ğŸ“Š Check Changes
      id: check_changes
      run: |
        if [[ -n $(git status -s) ]]; then
          echo "has_changes=true" >> $GITHUB_OUTPUT
        else
          echo "has_changes=false" >> $GITHUB_OUTPUT
        fi

    - name: ğŸ’¾ Commit Changes
      if: steps.check_changes.outputs.has_changes == 'true'
      run: |
        git add .

        # Random commit message
        MESSAGES=(
          "Update daily progress"
          "Add learning notes"
          "Document insights"
          "Update knowledge base"
          "Enhance documentation"
          "Add code snippets"
          "Update stats"
          "Refactor notes"
        )

        RANDOM_MSG=${MESSAGES[$RANDOM % ${#MESSAGES[@]}]}
        TIMESTAMP=$(date -u +%Y%m%d_%H%M%S)

        git commit -m "ğŸ¤– ${RANDOM_MSG} - ${TIMESTAMP}" || echo "Nothing to commit"

    - name: ğŸš€ Push Changes
      if: steps.check_changes.outputs.has_changes == 'true'
      run: |
        git push || echo "Push failed"

    - name: ğŸ“‹ Bot Report
      run: |
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "ğŸ¤– Enhanced Bot v3.0 Report"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "âœ… Status: Active"
        echo "ğŸ“… Time: $(date -u)"
        echo "ğŸ“‚ Repository: ${{ github.repository }}"
        echo "ğŸ”¥ Workflow: ${{ github.workflow }}"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

        if [ -f "bot_status.json" ]; then
          echo "ğŸ“Š Bot Statistics:"
          cat bot_status.json
        fi
